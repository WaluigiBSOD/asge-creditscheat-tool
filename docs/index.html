<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Alien Storm (Genesis) Credits Select Cheat Tool: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Alien Storm (Genesis) Credits Select Cheat Tool<span id="projectnumber">&#160;Version 1.0</span>
   </div>
   <div id="projectbrief">A command-line tool that computes some stuff regarding the Genesis Alien Storm game&#39;s credits select cheat.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Main Page </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#introduction">Introduction</a></li>
<li class="level1"><a href="#algorithm">The Algorithm</a><ul><li class="level2"><a href="#safe-solutions">Safe Solutions</a></li>
</ul>
</li>
<li class="level1"><a href="#rainbow-table">Rainbow Table</a></li>
<li class="level1"><a href="#minimum-lengths">Minimum Solution Lengths</a><ul><li class="level2"><a href="#shortest-sequence-length">Shortest Button Sequence Length</a></li>
</ul>
</li>
<li class="level1"><a href="#solutions">Computing Solutions</a><ul><li class="level2"><a href="#search-pruning">Recursive Search Pruning</a></li>
<li class="level2"><a href="#solution-properties">Minimum Length Solutions&#39; Properties</a></li>
</ul>
</li>
<li class="level1"><a href="#conclusions">Conclusions</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="introduction"></a>
Introduction</h1>
<p >While doing the usual adminitrative tasks on <a href="https://tcrf.net/">TCRF</a>, in mid-May 2022, a page in particular captured my attention. It was a Notes page detailing the algorithm behind <a href="https://tcrf.net/Alien_Storm_(Genesis)#Credits_Select">the Genesis Alien Storm's credit select cheat</a>, and as it didn't examine it deeply, decided to do it in some extent with a C++ program.</p>
<p >This program computes:</p><ul>
<li>a <a class="el" href="index.html#rainbow-table">rainbow table of the whole algorithm</a>, only for internal use</li>
<li><a class="el" href="index.html#minimum-lengths">minimum solution lengths</a>, regardless of the starting internal state, only for internal use</li>
<li>algorithm's prune tables, used to explain some <a class="el" href="index.html#solution-properties">algorithm's properties</a></li>
<li>all the <a class="el" href="index.html#solutions">solutions of minimum size</a>, and their number</li>
</ul>
<h1><a class="anchor" id="algorithm"></a>
The Algorithm</h1>
<p >A disassembly of the algorithm can be found on <a href="https://tcrf.net/Notes:Alien_Storm_(Genesis)#Credits_Select">its Notes page</a>. Essentially, considering only the cheat computation logic, it does:</p><ol type="1">
<li>Initialize a 16-bit memory location to <code>0x0000</code> </li>
<li>XOR it with the current pressed button's code in memory if any (any button except <b>Start</b> is allowed) <br  />
</li>
<li>Replace its content with a unitary right bit-shift of itself</li>
<li>If before doing step #3 its least significant bit was set, XOR it with <code>0x8810</code> </li>
<li>Repeat from step #2 until its value is equal to <code>0x3929</code> </li>
</ol>
<h2><a class="anchor" id="safe-solutions"></a>
Safe Solutions</h2>
<p >A valid solution consists in a button sequence that involves pressing <b>Up</b>, <b>Down</b>, <b>Left</b>, <b>Right</b>, <b>C</b>, <b>A</b>, <b>B</b> done using a standard controller. Ones that contain the <b>Left</b> and <b>Right</b> buttons may accidentally remap buttons in the Options menu, leading to a failed cheat. Sequences that don't involve pressing the <b>Left</b> or <b>Right</b> buttons are <em>safe</em>, and are called as such inside the program's code and there too.</p>
<h1><a class="anchor" id="rainbow-table"></a>
Rainbow Table</h1>
<p >The very first thing this program does is caching the algorithm inside a rainbow table in RAM, done inside <a class="el" href="_compute_rainbow_table_8cpp.html" title="Functions for computing the algorithm&#39;s rainbow table.">ComputeRainbowTable.cpp</a>, to avoid stressing the CPU by doing repetititve computations.</p>
<p >It's not stored inside a file, as it's needed only internally by the program.</p>
<h1><a class="anchor" id="minimum-lengths"></a>
Minimum Solution Lengths</h1>
<p >After having computed the rainbow table, the next step is to compute minimum solution lengths regardless of the starting internal state value (but still depending on the final one).</p>
<p >Are computed by an iterative approach, inside <a class="el" href="_compute_minimum_solution_lengths_8cpp.html" title="Functions for computing minimum solution lengths, regardless of the initial internal state.">ComputeMinimumSolutionLengths.cpp</a>, for every possible starting value that the internal state can have.</p>
<p >Due to the algorithm's nature, these lengths can be used to</p><ul>
<li>determine the <a class="el" href="index.html#shortest-sequence-length">shortest button sequence length</a> that yields to a successful cheat</li>
<li>optimize the recursive search of them, by <a class="el" href="index.html#search-pruning">pruning internal state values</a> that yield to a solution with more than what's being looked into</li>
<li>find an explanation of <a class="el" href="index.html#solution-properties">some properties of the minimum length solutions</a></li>
</ul>
<p >Are not stored inside a file, as are needed only internally by the program.</p>
<h2><a class="anchor" id="shortest-sequence-length"></a>
Shortest Button Sequence Length</h2>
<p >For an initializer of <code>0x0000</code>, the shortest button sequence that yields to a successful cheat is 9, as was already known. So, the program will find all the valid solutions of this length.</p>
<h1><a class="anchor" id="solutions"></a>
Computing Solutions</h1>
<p >After everything is ready, the program computes all the solutions of length 9 in <a class="el" href="_compute_solutions_8cpp.html" title="Functions for computing all the solutions of a certain minimum length, for a certain initial internal...">ComputeSolutions.cpp</a> and saves them inside a CSV file. Safe ones are stored into a separate file from the one containig all of them.</p>
<p >The total number of length 9 ones is just <em>1724</em> (<b>only 0.00022055% of all the possible button combinations of length 9</b>), where the safe ones are <em>just 89</em> (<b>only 5.16241% of the all the solutions of length 9</b>).</p>
<h2><a class="anchor" id="search-pruning"></a>
Recursive Search Pruning</h2>
<p >Minimum solution lengths can be used to prune the solution search algorithm by skipping all the branches that yield to a solution with a longer minimum length that what is left to compute. For example, if at a certain depth an internal state with a minimum solution length of 12 is encountered and only 8 inputs are left, there is no need to branch to it recursively as can be determined in advance that will not lead to any solution for needing more inputs than what is left.</p>
<p >On searching for solutions of length 9, this pruning technique reduces the algorithm's maximum number of iterations from <em>47079207</em> to <em>just 23128</em> (approximately <b>only the 0.05% of the former</b>).</p>
<p >Such tables are saved inside CSV files before computing minimum length solutions, one for all solutions and another for only safe ones, from <a class="el" href="_compute_prune_tables_8cpp.html" title="Functions for for computing prune tables.">ComputePruneTables.cpp</a>.</p>
<h2><a class="anchor" id="solution-properties"></a>
Minimum Length Solutions' Properties</h2>
<p >For an internal state initializer of <code>0x0000</code>, solutions of minimum length have some interesting properties that can be explained by knowing the minimum solution length that is yielded by some branches.</p><ul>
<li><p class="startli">All the solutions of length 9 begin with <b>Up</b>.</p>
<p class="startli">For an internal state of <code>0x0000</code>, a solution length of 9 and no input before, the following prune table can be created: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Initial State   </th><th class="markdownTableHeadCenter">Button Pressed   </th><th class="markdownTableHeadCenter">Resulting State   </th><th class="markdownTableHeadCenter">Cached Remaining Depth   </th><th class="markdownTableHeadCenter">Actual Remaining Depth   </th><th class="markdownTableHeadCenter">Decision    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0x0000</code>   </td><td class="markdownTableBodyCenter">Up   </td><td class="markdownTableBodyCenter"><code>0x8810</code>   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter"><code>OK</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>0x0000</code>   </td><td class="markdownTableBodyCenter">Down   </td><td class="markdownTableBodyCenter"><code>0x0001</code>   </td><td class="markdownTableBodyCenter">10   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter"><code>PRUNED</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0x0000</code>   </td><td class="markdownTableBodyCenter">Left   </td><td class="markdownTableBodyCenter"><code>0x0002</code>   </td><td class="markdownTableBodyCenter">10   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter"><code>PRUNED</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>0x0000</code>   </td><td class="markdownTableBodyCenter">Right   </td><td class="markdownTableBodyCenter"><code>0x0004</code>   </td><td class="markdownTableBodyCenter">10   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter"><code>PRUNED</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0x0000</code>   </td><td class="markdownTableBodyCenter">C   </td><td class="markdownTableBodyCenter"><code>0x0008</code>   </td><td class="markdownTableBodyCenter">10   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter"><code>PRUNED</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>0x0000</code>   </td><td class="markdownTableBodyCenter">A   </td><td class="markdownTableBodyCenter"><code>0x0010</code>   </td><td class="markdownTableBodyCenter">10   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter"><code>PRUNED</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0x0000</code>   </td><td class="markdownTableBodyCenter">B   </td><td class="markdownTableBodyCenter"><code>0x0020</code>   </td><td class="markdownTableBodyCenter">10   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter"><code>PRUNED</code>   </td></tr>
</table>
<p>Having a solution that begins with something else than <b>Up</b> means having a minimum length of 11 (cached remaining depth + 1 input already considered), thus being incompatible with solutions of length 9.</p>
</li>
<li><p class="startli">All the solutions of length 9 cannot have <b>Up</b> as the second button to press.</p>
<p class="startli">For an internal state of 0x8810, a solution length of 9 and an <b>Up</b> input before, the following prune table can be created: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Initial State   </th><th class="markdownTableHeadCenter">Button Pressed   </th><th class="markdownTableHeadCenter">Resulting State   </th><th class="markdownTableHeadCenter">Cached Remaining Depth   </th><th class="markdownTableHeadCenter">Actual Remaining Depth   </th><th class="markdownTableHeadCenter">Decision    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0x8810</code>   </td><td class="markdownTableBodyCenter">Up   </td><td class="markdownTableBodyCenter"><code>0xCC18</code>   </td><td class="markdownTableBodyCenter">11   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter"><code>PRUNED</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>0x8810</code>   </td><td class="markdownTableBodyCenter">Down   </td><td class="markdownTableBodyCenter"><code>0x4409</code>   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter"><code>OK</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0x8810</code>   </td><td class="markdownTableBodyCenter">Left   </td><td class="markdownTableBodyCenter"><code>0x440A</code>   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter"><code>OK</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>0x8810</code>   </td><td class="markdownTableBodyCenter">Right   </td><td class="markdownTableBodyCenter"><code>0x440C</code>   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter"><code>OK</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0x8810</code>   </td><td class="markdownTableBodyCenter">C   </td><td class="markdownTableBodyCenter"><code>0x4400</code>   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter"><code>OK</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>0x8810</code>   </td><td class="markdownTableBodyCenter">A   </td><td class="markdownTableBodyCenter"><code>0x4418</code>   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter"><code>OK</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0x8810</code>   </td><td class="markdownTableBodyCenter">B   </td><td class="markdownTableBodyCenter"><code>0x4428</code>   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter"><code>OK</code>   </td></tr>
</table>
<p>Having a solution that begins with an <b>Up</b>, <b>Up</b> pattern means having a minimum length of 13 (cached remaining depth + 2 inputs already considered), thus being incompatible with solutions of length 9.</p>
</li>
</ul>
<h1><a class="anchor" id="conclusions"></a>
Conclusions</h1>
<p >Well, I have to say that this program was fun to write, also because I terribly like analyzing algorithms of various kind. I believe some parts should have been more detailed, but looks enough.</p>
<dl class="section author"><dt>Author</dt><dd>WaluigiBSOD </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May 31st, 2022 </dd></dl>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
